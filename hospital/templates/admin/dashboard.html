{% load static %}

<html>

<head>
    <title>Admin</title>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="{% static 'admin/css/vendors/bootstrap.min.css' %}" />
    <link rel="stylesheet" href="{% static 'admin/css/vendors/line-awesome.min.css' %}" />
    <link rel="stylesheet" href="{% static 'admin/css/pages/layout.css' %}" />
    <link rel="icon" href="{% static 'admin/images/covid-19.ico' %}" />
    <script src="{% static 'admin/js/vendors/jquery.min.js' %}"></script>
    <script src="{% static 'admin/js/vendors/bootstrap.bundle.min.js' %}"></script>
    <script src="{% static 'admin/js/global.js' %}"></script>
    <link rel="stylesheet" href="{% static 'admin/css/pages/dashboard.css' %}" />
    <link rel="stylesheet" href="{% static 'admin/css/vendors/Chart.min.css' %}" />
    <script src="{% static 'admin/js/vendors/Chart.bundle.min.js' %}"></script>
    <script src="{% static 'admin/js/dashboard.js' %}"></script>
</head>

<body>
    <header>
        <nav class="navbar navbar-expand-lg shadow-sm fixed-top"><a class="navbar-brand" href=""><img
                    src="{% static 'images/logo.png'%}" /><span>Admin</span></a>
            
    </header>
    <main>
        <div class="side-nav">
            <ul class="list-group list-group-flush"><a class="list-group-item" href=""
                    data-toggle="tooltip" data-placement="bottom" title="Dashboard"><i
                        class="las la-shapes la-lw"></i><span>dashboard</span></a><a class="list-group-item"
                    href="" data-toggle="tooltip" data-placement="bottom" title="Patients"><i
                        class="las la-user-injured la-lw"></i><span>patients</span></a><a class="list-group-item"
                    href="" data-toggle="tooltip" data-placement="bottom" title="Specialists"><i
                        class="las la-clinic-medical la-lw"></i><span>specialists</span></a><a class="list-group-item"
                    href="" data-toggle="tooltip" data-placement="bottom" title="Procurement"><i
                        class="las la-shopping-cart la-lw"></i><span>procurement</span></a>
                <hr class="divider" />
                <div class="aob-items">
                    <div class="card">
                        <div class="card-header"><img src="{% static 'admin/images/covid-19.svg' %}" /></div>
                        <div class="card-body">
                            <p><u><i class="las la-globe"></i>world</u></p>
                            <p>infected -<u>704,753,890</u></p>
                            <p>deaths -<u>7,010,681</u></p>
                        </div>
                        <div class="card-footer"><a class="btn btn-dark-red-f-gr btn-sm" href="https://covid19.who.int"
                                target="_blank">view COVID-19 info</a></div>
                    </div>
                </div>
            </ul>
        </div>
        <div class="main-content">
            <div class="container-fluid">
                <div class="section">
                    <div class="row">
                        <div class="col-md-6">
                            <h5 class="page-title"></h5>
                        </div>
                    </div>
                </div>
                <div class="section welcome-section">
                    <div class="section-content">
                        <div class="card-deck">
                            <div class="card welcome-content-card">
                                <div class="card-body">
                                    <div class="row">
                                        <div class="col-md-6 welcome-text-wrapper align-self-center">
                                            <h5>hello Admin</h5>
                                            <p>Welcome to your dashboard</p>
                                        </div>
                                </div>
                            </div>
                            <div class="card app-stats-card">
                                <div class="card-body">
                                    <div class="row text-center">
                                        <div class="col-md-4"><i
                                                class="las la-user-injured la-3x align-self-center"></i>
                                            <p>total patients</p>
                                            <h4>{{ patient_count }}</h4>
                                        </div>
                                        <div class="col-md-4"><i class="las la-user-md la-3x align-self-center"></i>
                                            <p>total doctors</p>
                                            <h4>{{ doctor_count }}</h4>
                                        </div>
                                        <div class="col-md-4"><i
                                                class="las la-clinic-medical la-3x align-self-center"></i>
                                            <p>total treatment</p>
                                            <h4><a href="">21</a></h4>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="section functionality-section">
                    <div class="section-content">
                        <div class="card-deck"><a class="card text-center" href="">
                                <div class="card-title">
                                    <div class="icon-wrapper"><i class="las la-clinic-medical"></i></div>
                                </div>
                                <div class="card-body">
                                    <p>add a treatment</p>
                                </div>
                            </a><a class="card text-center" href="">
                                <div class="card-title">
                                    <div class="icon-wrapper"><i class="las la-user-md"></i></div>
                                </div>
                                <div class="card-body">
                                    <p>add a specialist</p>
                                </div>
                            </a><a class="card text-center" href="{% url 'my_admin:patient_add' %}">
                                <div class="card-title">
                                    <div class="icon-wrapper"><i class="las la-user-plus"></i></div>
                                </div>
                                <div class="card-body">
                                    <p>add a user</p>
                                </div>
                            </a>
                            </a></div>
                    </div>
                </div>
                <div class="section card-summaries">
                    <div class="section-content">

                        <div class="card-deck">
                            <div class="card">
                                <div class="card-header">
                                    <h5>top treatments</h5>
                                </div>
                                <div class="card-body">
                                    <ol type="1">
                                        <li>consultation</li>
                                        <li>scaling</li>
                                        <li>root canal</li>
                                        <li>bleaching</li>
                                        <li>transplants</li>
                                        <li>cesarean</li>
                                        <li>x-rays</li>
                                    </ol>
                                </div>
                            </div>
                            <div class="card total-counts-summary">
                                <div class="card-header">
                                    <h5>total counts</h5>
                                </div>
                                <div class="card-body">
                                    <div class="row text-center text-capitalize">
                                        <div class="col-md-6"><i class="las la-users la-2x mb-1"></i>
                                            <h4 class="mb-1">{{ total_users }}</h4>
                                            <p>total users</p>
                                        </div>
                                        <div class="col-md-6"><i class="las la-user-md la-2x mb-1"></i>
                                            <h4 class="mb-1">{{ doctor_count }}</h4>
                                            <p>total doctors</p>
                                        </div>
                                        <div class="col-md-6"><i class="las la-user-injured la-2x mb-1"></i>
                                            <h4 class="mb-1">{{ patient_count }}</h4>
                                            <p>total patients</p>
                                        </div>
                                        <div class="col-md-6"><i class="las la-hospital la-2x mb-1"></i>
                                            <h4 class="mb-1">40</h4>
                                            <p>total treatments</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="card" style="width: 60px;">
                                <div class="card-header">
                                    <h5>Recent Patients</h5>
                                </div>
                                <div class="card-body">
                                    <table class="table table-hover table-responsive-md table-borderless">
                                        <tbody>
                                            {% for patient in recent_patients %}
                                            <tr>
                                                <td>
                                                    <img class="rounded-circle" src="{% static 'admin/images/hospitalisation.png' %}" />
                                                </td>

                                                <td>
                                                    <p>{{ patient.name }}</p>
                                                </td>
                                                <td>
                                                    <p class="text-muted">{{ patient.gender }}</p>
                                                </td>
                                                <td>
                                                    <button class="btn btn-sm"><i class="las la-ellipsis-h"></i></button>
                                                </td>
                                            </tr>
                                            {% empty %}
                                            <tr>
                                                <td colspan="4" class="text-center">No recent patients</td>
                                            </tr>
                                            {% endfor %}
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                            
                        </div>
                        <div class="card-deck">
                            <div class="card">
                                <div class="card-header">
                                    <h5>Doctors List</h5>
                                </div>
                                <div class="card-body">
                                    <table class="table table-borderless table-hover table-responsive-md">
                                        <tbody>
                                            {% for doctor in doctors %}
                                            <tr>
                                                <td>
                                                    <img class="rounded-circle" src="{% static 'admin/images/doctor.svg' %}" loading="lazy" />
                                                </td>
                                                <td>
                                                    <p>{{ doctor.name }}</p>
                                                    <small class="text-muted">{{ doctor.specialty }}</small>
                                                </td>
                                                <td>
                                                    <p class="text-muted">{{ doctor.gender }}</p>
                                                </td>
                                                <td class="text-right">
                                                    <p>{{ doctor.phone }}</p>
                                                </td>
                                                
                                                <td>
                                                    <button class="btn btn-sm"><i class="las la-ellipsis-h"></i></button>
                                                </td>
                                            </tr>
                                            {% empty %}
                                            <tr>
                                                <td colspan="6" class="text-center">No doctors available</td>
                                            </tr>
                                            {% endfor %}
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                            
                            <div class="card">
                                <div class="card-header">
                                    <h5>Upcoming Appointments</h5>
                                </div>
                                <div class="card-body">
                                    <table class="table table-borderless table-hover table-responsive-md">
                                        <tbody>
                                            {% for appointment in appoinments %}  <!-- Corrected key name -->
                                            <tr>
                                                <td>
                                                    <img class="rounded-circle" src="{% static 'admin/images/appointment.png' %}" loading="lazy" />
                                                </td>
                                                <td>
                                                    <p>{{ appointment.patient_name }}</p>
                                                    <small class="text-muted">{{ appointment.doctor_name }}</small>
                                                </td>
                                                <td>
                                                    <p class="text-muted">{{ appointment.date }}</p>
                                                </td>
                                                <td class="text-right">
                                                    {% if appointment.status == 'pending' %}
                                                    <button class="btn"><i class="las la-clock"></i></button>
                                                    {% elif appointment.status == 'upcoming' %}
                                                    <button class="btn"><i class="las la-hourglass-half"></i></button>
                                                    {% else %}
                                                    <button class="btn"><i class="las la-check-circle"></i></button>
                                                    {% endif %}
                                                </td>
                                                <td>
                                                    <form method="post" action="{% url 'cancel_appointment' %}" class="mt-2">
                                                        {% csrf_token %}
                                                        <input type="hidden" name="appointment_id" value="{{ appointment.id }}"> 
                                                        <input type="hidden" name="cancel_type" value="admin"> 
                                                        <button type="submit" class="btn btn-sm mr-2"><i class="las la-times-circle"></i></button>
                                                    </form>
                                                </td>
                                            </tr>
                                            {% empty %}
                                            <tr>
                                                <td colspan="6" class="text-center">No upcoming appointments</td>
                                            </tr>
                                            {% endfor %}
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                                
                                
                            </div>
                        </div>
                    </div>
                </div>
            <footer>
                <div class="page-footer text-center">
                    <div class="fixed-bottom shadow-sm"><a href="https://covid19.who.int" target="_blank"><img
                                src="{% static 'admin/images/covid-19.svg' %}" /><span>view COVID-19 info</span></a></div>
                </div>
            </footer>
        </div>
</body>

</html>